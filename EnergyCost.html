<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>各類能源成本分析 - v1.8 標籤間距修正版</title>
    <!-- 
      /* --- SYSTEM ARCHITECTURE: EnergyCost v1.8 --- */
      1. 標籤修正：將橫式長條圖標籤 offsetX 調整為 30，縮短數值與圖形間距。
      2. 空間優化：縮減圖表右側留白 Padding 至 50，提升版面資訊密度。
      3. 整合：完整保留 2025 價格看板、自發購電對比及歷史趨勢折線圖。
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&family=Inter:wght@400;700;900&display=swap');
        
        :root {
            --brand-primary: #4f46e5;
            --brand-indigo: #4338ca;
            --brand-emerald: #10b981;
            --brand-amber: #f59e0b;
            --brand-rose: #f43f5e;
            --bg-main: #f8fafc;
        }

        body { 
            font-family: 'Inter', 'Noto Sans TC', sans-serif; 
            background-color: var(--bg-main); 
            color: #1e293b;
            margin: 0;
            overflow: hidden;
            font-size: 18px; 
        }

        .main-scroll {
            height: 100vh;
            overflow-y: auto;
            padding-bottom: 6rem;
            scroll-behavior: smooth;
        }

        .glass-card {
            background: #ffffff;
            border-radius: 1.5rem;
            border: 1px solid rgba(226, 232, 240, 0.8);
            box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
        }

        #loader {
            position: fixed;
            inset: 0;
            background: #ffffff;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-scroll::-webkit-scrollbar { width: 5px; }
        .main-scroll::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50">

    <div id="loader">
        <div class="flex flex-col items-center gap-4">
            <div class="w-12 h-12 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
            <p class="text-xs font-black text-slate-400 tracking-widest uppercase">Refining Layout Metrics...</p>
        </div>
    </div>

    <div class="main-scroll p-6 md:p-10 lg:p-14">
        <div class="max-w-[1500px] mx-auto space-y-10">
            
            <!-- 頂部標題 -->
            <header class="flex flex-col md:flex-row md:items-end justify-between gap-6 border-b border-slate-200 pb-8">
                <div class="space-y-3">
                    <div class="inline-flex items-center gap-3 px-4 py-1.5 bg-amber-50 rounded-full mb-1">
                        <span class="w-2.5 h-2.5 rounded-full bg-amber-500 animate-pulse"></span>
                        <span class="text-amber-600 font-black text-xs uppercase tracking-[0.15em]">Official Cost & Trend Hub</span>
                    </div>
                    <h2 class="text-4xl md:text-6xl font-black tracking-tighter text-slate-900 leading-tight">各類能源成本</h2>
                    <p class="text-slate-500 font-medium text-lg md:text-2xl leading-relaxed">整合 2017-2025 歷史趨勢與 114 年最新自發/購電成本比較。</p>
                </div>
                <div class="text-right space-y-1">
                    <p class="text-xs font-black text-slate-400 uppercase tracking-widest">Price Unit</p>
                    <p class="text-2xl font-black text-slate-800">TWD 元 / 度 (kWh)</p>
                </div>
            </header>

            <!-- 第一區塊：核心數據看板 -->
            <section class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="glass-card p-8 flex flex-col items-center justify-center border-l-8 border-l-amber-400">
                    <p class="text-sm font-black text-slate-400 uppercase mb-3">2025 太陽能 (地面)</p>
                    <p class="text-5xl font-black text-slate-800">3.52 <span class="text-lg text-slate-300">元</span></p>
                    <span class="mt-3 text-xs font-bold text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full">-22.6% vs 2017</span>
                </div>
                <div class="glass-card p-8 flex flex-col items-center justify-center border-l-8 border-l-emerald-400">
                    <p class="text-sm font-black text-slate-400 uppercase mb-3">2025 陸域風力</p>
                    <p class="text-5xl font-black text-slate-800">2.13 <span class="text-lg text-slate-300">元</span></p>
                    <span class="mt-3 text-xs font-bold text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full">-26.0% vs 2017</span>
                </div>
                <div class="glass-card p-8 flex flex-col items-center justify-center border-l-8 border-l-indigo-400">
                    <p class="text-sm font-black text-slate-400 uppercase mb-3">2025 離岸風力</p>
                    <p class="text-5xl font-black text-slate-800">4.51 <span class="text-lg text-slate-300">元</span></p>
                    <span class="mt-3 text-xs font-bold text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full">-25.3% vs 2017</span>
                </div>
                <div class="glass-card p-8 flex flex-col items-center justify-center border-l-8 border-l-rose-400 bg-rose-50/30">
                    <p class="text-sm font-black text-slate-400 uppercase mb-3">2025 平均售電價格</p>
                    <p class="text-5xl font-black text-slate-900 tracking-tighter">3.92 <span class="text-lg text-slate-300">元</span></p>
                    <span class="mt-3 text-xs font-bold text-rose-600 bg-rose-50 px-3 py-1 rounded-full">+53.7% vs 2017</span>
                </div>
            </section>

            <!-- 第二區塊：台電自發與購電對比圖 (標籤修正版) -->
            <section class="glass-card p-10 md:p-14 border-t-8 border-t-indigo-600">
                <div class="flex flex-col md:flex-row md:items-center justify-between mb-12 gap-6">
                    <div class="space-y-2">
                        <h3 class="font-black text-slate-900 text-3xl tracking-tight">台電自發與購電成本比較 (114年1-10月)</h3>
                        <p class="text-slate-400 text-sm font-bold uppercase tracking-widest">Self-Generation vs. External Purchase Comparison</p>
                    </div>
                    <div class="flex items-center gap-6 text-sm font-black">
                        <div class="flex items-center gap-2"><span class="w-4 h-4 bg-indigo-600 rounded"></span> 台電自發</div>
                        <div class="flex items-center gap-2"><span class="w-4 h-4 bg-amber-500 rounded"></span> 購入電力</div>
                    </div>
                </div>

                <div id="comparison-bar-chart" style="min-height: 550px;"></div>

                <div class="mt-10 p-6 bg-slate-50 rounded-2xl border border-slate-100">
                    <p class="text-slate-600 text-base leading-relaxed font-medium italic">
                        註：地熱自發成本 (16.38元) 包含初期建置攤提與研發投入，數值較高。外部購入電力之再生能源成本 (5.46元) 則受早期高額躉購合約 (FIT) 影響。
                    </p>
                </div>
            </section>

            <!-- 第三區塊：能源價格與費率歷史數據趨勢 (2017-2025) -->
            <section class="glass-card p-10 md:p-14">
                <div class="flex flex-col md:flex-row md:items-center justify-between mb-12 gap-6">
                    <div class="space-y-2">
                        <h3 class="font-black text-slate-900 text-3xl tracking-tight">能源價格與費率歷史數據趨勢 (2017-2025)</h3>
                        <p class="text-slate-400 text-sm font-bold uppercase tracking-widest">Long-term Cost Evolution Analysis</p>
                    </div>
                    <div class="flex flex-wrap items-center gap-6 text-xs font-black text-slate-500">
                        <div class="flex items-center gap-2"><span class="w-4 h-1.5 bg-amber-400 rounded-full"></span> 太陽能</div>
                        <div class="flex items-center gap-2"><span class="w-4 h-1.5 bg-emerald-500 rounded-full"></span> 陸域風力</div>
                        <div class="flex items-center gap-2"><span class="w-4 h-1.5 bg-indigo-500 rounded-full"></span> 離岸風力</div>
                        <div class="flex items-center gap-2"><span class="w-6 h-0.5 border-t-4 border-rose-500 border-dashed"></span> 平均售電價</div>
                    </div>
                </div>
                
                <div id="cost-trend-chart" style="min-height: 500px;"></div>
                
                <div class="mt-12 p-8 bg-indigo-50/50 rounded-2xl border border-indigo-100 flex gap-6 items-start">
                    <div class="bg-white p-3 rounded-xl shadow-sm">
                        <i data-lucide="trending-down" class="text-indigo-600 w-8 h-8"></i>
                    </div>
                    <div class="space-y-2">
                        <h4 class="font-black text-indigo-900 text-xl">策略洞察：成本轉折點</h4>
                        <p class="text-indigo-800 leading-relaxed font-medium text-xl">
                            2025 年垂直標註線代表了<strong>太陽能地面型成本正式低於平均售電價格</strong>的轉折。隨著外部購入能源成本的持續高漲，發展再生能源不僅具備碳中和效益，更是國家維持穩定、具競爭力電價的重要經濟策略。
                        </p>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <script>
        const COMPARE_DATA = [
            { type: '燃煤', self: 2.18, purchase: 2.81 },
            { type: '燃氣', self: 2.82, purchase: 3.40 },
            { type: '核能', self: 1.98, purchase: 0 },
            { type: '慣常水力', self: 1.17, purchase: 2.19 },
            { type: '太陽光電', self: 3.93, purchase: 4.88 },
            { type: '風力發電', self: 5.52, purchase: 6.63 },
            { type: '地熱', self: 16.38, purchase: 6.58 }
        ];

        const TREND_DATA = [
            { 年度: 2017, 太陽能: 4.55, 陸域風力: 2.88, 離岸風力: 6.04, 售電價格: 2.55 },
            { 年度: 2018, 太陽能: 4.29, 陸域風力: 2.77, 離岸風力: 5.85, 售電價格: 2.60 },
            { 年度: 2019, 太陽能: 4.04, 陸域風力: 2.54, 離岸風力: 5.52, 售電價格: 2.62 },
            { 年度: 2020, 太陽能: 3.88, 陸域風力: 2.32, 離岸風力: 5.09, 售電價格: 2.60 },
            { 年度: 2021, 太陽能: 3.72, 陸域風力: 2.30, 離岸風力: 4.66, 售電價格: 2.59 },
            { 年度: 2022, 太陽能: 3.87, 陸域風力: 2.12, 離岸風力: 4.50, 售電價格: 2.72 },
            { 年度: 2023, 太陽能: 3.87, 陸域風力: 2.13, 離岸風力: 4.51, 售電價格: 3.07 },
            { 年度: 2024, 太陽能: 3.74, 陸域風力: 2.13, 離岸風力: 4.51, 售電價格: 3.48 },
            { 年度: 2025, 太陽能: 3.52, 陸域風力: 2.13, 離岸風力: 4.51, 售電價格: 3.92 }
        ];

        function initCharts() {
            lucide.createIcons();

            // 1. 比較長條圖 (標籤位移修正)
            const compOptions = {
                series: [
                    { name: '台電自發成本', data: COMPARE_DATA.map(d => d.self) },
                    { name: '購入電力成本', data: COMPARE_DATA.map(d => d.purchase) }
                ],
                chart: { type: 'bar', height: 550, toolbar: { show: false }, fontFamily: 'Inter, Noto Sans TC' },
                plotOptions: { 
                    bar: { 
                        horizontal: true, 
                        barHeight: '70%', 
                        borderRadius: 6, 
                        dataLabels: { 
                            position: 'top' 
                        } 
                    } 
                },
                colors: ['#4338ca', '#f59e0b'],
                dataLabels: {
                    enabled: true,
                    /* --- 依照需求修正：140 改為 30 --- */
                    offsetX: 30,      
                    textAnchor: 'start', 
                    style: { fontSize: '15px', fontWeight: 900, colors: ['#1e293b'] },
                    formatter: (v) => v > 0 ? v.toFixed(2) : ''
                },
                xaxis: {
                    categories: COMPARE_DATA.map(d => d.type),
                    labels: { style: { fontWeight: 900, fontSize: '14px' } }
                },
                yaxis: { labels: { style: { fontWeight: 900, fontSize: '16px' } } },
                grid: { 
                    borderColor: '#f1f5f9', 
                    /* --- 依照需求修正：200 改為 50 --- */
                    padding: { right: 50 } 
                },
                legend: { show: false },
                tooltip: { theme: 'dark', y: { formatter: (v) => v.toFixed(2) + " 元" } }
            };

            // 2. 趨勢折線圖
            const trendOptions = {
                series: [
                    { name: '太陽能 (地面型)', data: TREND_DATA.map(d => d.太陽能) },
                    { name: '陸域風力', data: TREND_DATA.map(d => d.陸域風力) },
                    { name: '離岸風力', data: TREND_DATA.map(d => d.離岸風力) },
                    { name: '平均公用售電價格', data: TREND_DATA.map(d => d.售電價格) }
                ],
                chart: { type: 'line', height: 500, toolbar: { show: false }, fontFamily: 'Inter, Noto Sans TC' },
                colors: ['#f59e0b', '#10b981', '#4f46e5', '#f43f5e'],
                stroke: { width: [4, 4, 4, 6], curve: 'smooth', dashArray: [0, 0, 0, 8] },
                markers: { size: 6, strokeWidth: 3, hover: { size: 9 } },
                xaxis: { 
                    categories: TREND_DATA.map(d => d.年度),
                    labels: { style: { fontWeight: 900, fontSize: '14px' } }
                },
                yaxis: { 
                    min: 0, max: 7, 
                    labels: { style: { fontWeight: 900, fontSize: '14px' } },
                    title: { text: '元 / 度', style: { fontWeight: 900 } }
                },
                grid: { borderColor: '#f1f5f9', strokeDashArray: 4, padding: { right: 30 } },
                legend: { position: 'top', horizontalAlign: 'right', fontWeight: 700 },
                tooltip: { theme: 'dark', y: { formatter: (v) => v.toFixed(2) + " 元" } },
                annotations: {
                    xaxis: [{
                        x: 2025, borderColor: '#4f46e5', strokeDashArray: 4, borderWidth: 3,
                        label: {
                            textAnchor: 'end', offsetX: -15,
                            style: { color: '#fff', background: '#4f46e5', fontWeight: 900, fontSize: '14px', padding: { left: 12, right: 12, top: 6, bottom: 6 } },
                            text: '2025 市電同價臨界點', orientation: 'horizontal', position: 'top'
                        }
                    }]
                }
            };

            new ApexCharts(document.querySelector("#comparison-bar-chart"), compOptions).render();
            new ApexCharts(document.querySelector("#cost-trend-chart"), trendOptions).render();

            setTimeout(() => {
                const loader = document.getElementById('loader');
                if (loader) {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 500);
                }
            }, 300);
        }

        document.addEventListener("DOMContentLoaded", initCharts);
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2050 èƒ½æºè·¯å¾‘èˆ‡ä¾›éœ€æ¨ä¼°æ¨¡å‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .card { background: white; border-radius: 1rem; border: 1px solid #e2e8f0; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        input[type="number"] { font-family: ui-monospace, monospace; }
        .active-tab { background-color: #3b82f6 !important; color: white !important; }
        .chart-container { position: relative; width: 100%; }
    </style>
</head>
<body class="p-4 md:p-8 text-slate-800">
    <div class="max-w-[1400px] mx-auto">
        <!-- Header -->
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-slate-900 tracking-tight">2050 èƒ½æºè½‰å‹è·¯å¾‘æ¨ä¼°å·¥å…·</h1>
            <p class="text-slate-500 mt-2 text-sm md:text-base">æ•¸æ“šåŸºç¤ï¼š2024å¹´åº•å¯¦ç¸¾ | æœªä¾†è¦åŠƒï¼šä¾æ“šæä¾›ä¹‹é›»æºä¾›çµ¦è¦åŠƒèˆ‡èƒ½æºæ”¿ç­–æ–¹å‘</p>
        </header>

        <div class="grid grid-cols-1 xl:grid-cols-12 gap-8">
            <!-- Left: Inputs -->
            <div class="xl:col-span-7 space-y-6">
                <!-- Demand Side -->
                <div class="card p-6 border-t-4 border-t-orange-500">
                    <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <span class="text-orange-500">ğŸ¢</span> éœ€æ±‚ç«¯ï¼šé•·æœŸæˆé•·è¨­å®š
                    </h2>
                    <div class="flex items-center gap-6 bg-orange-50 p-4 rounded-xl">
                        <div class="flex-1">
                            <label class="block text-sm font-semibold text-orange-800 mb-1">å¹´å‡ç”¨é›»æˆé•·ç‡ (%)</label>
                            <input type="range" id="growthRange" min="0" max="5" step="0.1" value="2.5" oninput="syncGrowth(this.value)" class="w-full accent-orange-600">
                        </div>
                        <div class="text-center">
                            <input type="number" id="growthRate" value="2.5" step="0.1" oninput="syncGrowth(this.value)" class="w-20 border-2 border-orange-200 rounded-lg p-2 text-xl font-bold text-orange-600 focus:border-orange-500 outline-none">
                        </div>
                        <div class="hidden md:block text-xs text-orange-700/60 leading-tight">
                            åŸºæœŸ(2024)ï¼š282 TWh<br>è¨ˆç®—æ–¹å¼ï¼šè¤‡åˆ©æˆé•·
                        </div>
                    </div>
                </div>

                <!-- Supply Side Table -->
                <div class="card p-6 border-t-4 border-t-blue-500">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                        <h2 class="text-lg font-bold flex items-center gap-2">
                            <span class="text-blue-500">âš¡</span> ä¾›çµ¦ç«¯ï¼šåˆ†éšæ®µè£ç½®å®¹é‡ (GW)
                        </h2>
                        <button onclick="addRow()" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-sm transition-all flex items-center gap-1">
                            <span>+</span> æ–°å¢èƒ½æº
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse" id="energyTable">
                            <thead>
                                <tr class="text-slate-400 text-[10px] uppercase tracking-widest border-b border-slate-100">
                                    <th class="pb-3 font-semibold pr-2">èƒ½æºé¡åˆ¥</th>
                                    <th class="pb-3 font-semibold text-center w-16 px-1">CF(%)</th>
                                    <th class="pb-3 font-semibold text-center px-1 bg-blue-50/50 rounded-t-lg">2026</th>
                                    <th class="pb-3 font-semibold text-center px-1 bg-blue-50/50">2030</th>
                                    <th class="pb-3 font-semibold text-center px-1 bg-blue-50/50">2035</th>
                                    <th class="pb-3 font-semibold text-center px-1 bg-blue-50/50 rounded-t-lg">2050</th>
                                    <th class="pb-3 w-8"></th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-50 text-[13px]">
                                <!-- ç‡ƒæ°£ï¼šä¾æ“šè¦åŠƒ JSON ç´¯åŠ è¨ˆç®— -->
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">ç‡ƒæ°£ç™¼é›» (LNG)</td>
                                    <td><input type="number" value="66.58" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="24.99" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="31.18" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="33.77" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="35.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold text-blue-700"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">ç‡ƒç…¤ç™¼é›» (Coal)</td>
                                    <td><input type="number" value="66.82" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="18.00" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="12.00" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="5.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="0.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold text-blue-700"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">å¤ªé™½å…‰é›» (PV)</td>
                                    <td><input type="number" value="13.54" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="18.50" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5 text-green-600"></td>
                                    <td class="px-1"><input type="number" value="30.00" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5 text-green-600"></td>
                                    <td class="px-1"><input type="number" value="50.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5 text-green-600"></td>
                                    <td class="px-1"><input type="number" value="80.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold text-green-700 bg-green-50"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">é›¢å²¸é¢¨é›»</td>
                                    <td><input type="number" value="38.97" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="5.60" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5 text-green-600"></td>
                                    <td class="px-1"><input type="number" value="13.10" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5 text-green-600"></td>
                                    <td class="px-1"><input type="number" value="20.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5 text-green-600"></td>
                                    <td class="px-1"><input type="number" value="40.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold text-green-700 bg-green-50"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">æŠ½è“„æ°´åŠ›</td>
                                    <td><input type="number" value="13.61" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="2.60" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="2.60" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="3.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="4.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">å„²èƒ½ (Storage)</td>
                                    <td><input type="number" value="5.00" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="1.00" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5 text-indigo-600"></td>
                                    <td class="px-1"><input type="number" value="3.00" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5 text-indigo-600"></td>
                                    <td class="px-1"><input type="number" value="6.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5 text-indigo-600"></td>
                                    <td class="px-1"><input type="number" value="15.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold text-indigo-700 bg-indigo-50"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">æ ¸èƒ½</td>
                                    <td><input type="number" value="90.74" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="0.00" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="0.00" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="0.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="0.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">æ…£å¸¸æ°´åŠ›</td>
                                    <td><input type="number" value="22.27" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="2.12" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="2.50" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="3.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="4.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                                <tr class="energy-row">
                                    <td class="py-2 pr-2 font-semibold text-slate-700">å»¢æ£„ç‰©/ç”Ÿè³ªèƒ½</td>
                                    <td><input type="number" value="63.95" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                                    <td class="px-1"><input type="number" value="0.70" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="1.20" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="2.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                                    <td class="px-1"><input type="number" value="5.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold"></td>
                                    <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Right: Analysis Charts -->
            <div class="xl:col-span-5 space-y-6">
                <!-- Chart 1: Trend Bar -->
                <div class="card p-6">
                    <h2 class="text-lg font-bold text-slate-700 mb-6 flex justify-between items-center">
                        ä¾›éœ€å¹³è¡¡è·¯å¾‘ (TWh)
                        <span class="text-[10px] font-normal text-slate-400 border border-slate-200 px-2 py-1 rounded">2026 - 2050</span>
                    </h2>
                    <div class="chart-container h-80">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <!-- Chart 2: Mix Doughnut with Tabs -->
                <div class="card p-6">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-6">
                        <h2 class="text-lg font-bold text-slate-700">ç™¼é›»é…æ¯”åˆ†æ (%)</h2>
                        <div class="flex bg-slate-100 p-1 rounded-lg">
                            <button onclick="changeMixYear(2026)" class="mix-tab active-tab px-3 py-1 rounded-md text-[10px] font-bold uppercase transition-all" id="tab2026">2026</button>
                            <button onclick="changeMixYear(2030)" class="mix-tab px-3 py-1 rounded-md text-[10px] font-bold uppercase transition-all" id="tab2030">2030</button>
                            <button onclick="changeMixYear(2035)" class="mix-tab px-3 py-1 rounded-md text-[10px] font-bold uppercase transition-all" id="tab2035">2035</button>
                            <button onclick="changeMixYear(2050)" class="mix-tab px-3 py-1 rounded-md text-[10px] font-bold uppercase transition-all" id="tab2050">2050</button>
                        </div>
                    </div>
                    <div class="chart-container h-96">
                        <canvas id="mixChart"></canvas>
                    </div>
                    <div class="mt-4 pt-4 border-t border-slate-50 text-center">
                        <p class="text-xs text-slate-400 font-medium tracking-wide">
                            <span id="displayYearText">2026</span> å¹´åº¦ç¸½ä¾›çµ¦ï¼š<span id="displayYearGen" class="text-blue-600 font-bold">0</span> TWh
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="mt-12 text-center text-slate-400 text-xs py-8 border-t border-slate-200">
            Â© èƒ½æºé…æ¯”è·¯å¾‘æ¨¡æ“¬å·¥å…· | åŸºæœŸï¼š2024 (282 TWh) | åŒ…å«æŠ½è“„æ°´åŠ›èˆ‡å„²èƒ½èª¿åº¦è€ƒé‡
        </footer>
    </div>

    <script>
        // è¨»å†Šæ•¸æ“šæ¨™ç±¤æ’ä»¶
        Chart.register(ChartDataLabels);

        // è‡ªå®šç¾©æ’ä»¶ï¼šåœ¨åœ“é¤…åœ–ä¸­é–“é¡¯ç¤ºæ–‡å­—
        const centerTextPlugin = {
            id: 'centerText',
            afterDraw: (chart) => {
                if (chart.config.type !== 'doughnut') return;
                const { ctx, chartArea: { top, bottom, left, right, width, height } } = chart;
                ctx.save();
                
                const renewablePercent = chart.config.options.renewableValue || 0;
                const centerX = (left + right) / 2;
                const centerY = (top + bottom) / 2;

                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                ctx.font = 'bold 12px Inter, "Microsoft JhengHei"';
                ctx.fillStyle = '#64748b';
                ctx.fillText('å†ç”Ÿèƒ½æºä½”æ¯”', centerX, centerY - 12);

                ctx.font = 'bold 24px Inter, "Microsoft JhengHei"';
                ctx.fillStyle = '#10b981';
                ctx.fillText(renewablePercent + '%', centerX, centerY + 12);
                
                ctx.restore();
            }
        };
        Chart.register(centerTextPlugin);

        let trendChart, mixChart;
        let currentMixYear = 2026;
        const baseDemand = 282;
        const targetYears = [2026, 2030, 2035, 2050];
        
        let annualData = {
            2026: { labels: [], gens: [], total: 0, renewableTotal: 0 },
            2030: { labels: [], gens: [], total: 0, renewableTotal: 0 },
            2035: { labels: [], gens: [], total: 0, renewableTotal: 0 },
            2050: { labels: [], gens: [], total: 0, renewableTotal: 0 }
        };

        function initCharts() {
            const ctxTrend = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(ctxTrend, {
                type: 'bar',
                data: {
                    labels: targetYears.map(y => y + 'å¹´'),
                    datasets: [
                        { label: 'é ä¼°ç¸½ä¾›çµ¦ (TWh)', data: [], backgroundColor: '#3b82f6', borderRadius: 4 },
                        { label: 'é ä¼°ç¸½éœ€æ±‚ (TWh)', data: [], backgroundColor: '#f97316', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: { padding: { top: 30 } },
                    scales: { 
                        y: { beginAtZero: true, grid: { borderDash: [5, 5], color: '#e2e8f0' } },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 10, font: { size: 11, weight: '600' } } },
                        datalabels: {
                            anchor: 'end', align: 'top', color: '#475569',
                            font: { size: 10, weight: 'bold' },
                            formatter: (value) => Math.round(value)
                        },
                        centerText: false
                    }
                }
            });

            const ctxMix = document.getElementById('mixChart').getContext('2d');
            mixChart = new Chart(ctxMix, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: ['#3b82f6', '#64748b', '#fbbf24', '#06b6d4', '#10b981', '#6366f1', '#f43f5e', '#f59e0b', '#14b8a6', '#8b5cf6'],
                        borderWidth: 2, borderColor: '#ffffff', hoverOffset: 12
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: { padding: 45 },
                    renewableValue: 0,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: true },
                        datalabels: {
                            color: '#334155', anchor: 'end', align: 'end', offset: 10,
                            font: { size: 10, weight: '600' },
                            display: (context) => context.dataset.data[context.dataIndex] > 1 ? 'auto' : false,
                            formatter: (value, context) => {
                                const label = context.chart.data.labels[context.dataIndex];
                                return `${label}\n${value}%`;
                            },
                            textAlign: 'center', padding: 4
                        }
                    },
                    cutout: '70%'
                }
            });
        }

        function isRenewable(name) {
            const keywords = ['å¤ªé™½', 'é¢¨', 'æ°´', 'å»¢æ£„ç‰©', 'ç”Ÿè³ª', 'åœ°ç†±', 'PV', 'å„²èƒ½'];
            return keywords.some(key => name.includes(key));
        }

        function syncGrowth(val) {
            document.getElementById('growthRange').value = val;
            document.getElementById('growthRate').value = val;
            calculate();
        }

        function changeMixYear(year) {
            currentMixYear = year;
            document.querySelectorAll('.mix-tab').forEach(t => t.classList.remove('active-tab'));
            document.getElementById('tab' + year).classList.add('active-tab');
            updateMixChartDisplay();
        }

        function calculate() {
            const rows = document.querySelectorAll('.energy-row');
            const rate = parseFloat(document.getElementById('growthRate').value) || 0;
            
            targetYears.forEach(y => {
                annualData[y] = { labels: [], gens: [], total: 0, renewableTotal: 0 };
            });

            rows.forEach(row => {
                const nameTd = row.querySelector('td:first-child');
                const name = nameTd ? nameTd.innerText : "æœªçŸ¥";
                const cf = parseFloat(row.querySelector('.cf-input').value) || 0;

                targetYears.forEach(year => {
                    const capInput = row.querySelector('.cap-' + year);
                    const cap = capInput ? parseFloat(capInput.value) || 0 : 0;
                    // TWh = GW * 8760h * CF / 1000
                    const gen = (cap * 8760 * (cf / 100)) / 1000;
                    
                    annualData[year].labels.push(name);
                    annualData[year].gens.push(gen);
                    annualData[year].total += gen;
                    if (isRenewable(name)) {
                        annualData[year].renewableTotal += gen;
                    }
                });
            });

            const demandPoints = targetYears.map(year => {
                return baseDemand * Math.pow(1 + (rate / 100), year - 2024);
            });

            trendChart.data.datasets[0].data = targetYears.map(y => annualData[y].total);
            trendChart.data.datasets[1].data = demandPoints;
            trendChart.update();

            updateMixChartDisplay();
        }

        function updateMixChartDisplay() {
            const data = annualData[currentMixYear];
            const percentages = data.gens.map(g => data.total > 0 ? parseFloat(((g / data.total) * 100).toFixed(1)) : 0);
            const renewablePercent = data.total > 0 ? ((data.renewableTotal / data.total) * 100).toFixed(1) : 0;
            
            mixChart.data.labels = data.labels;
            mixChart.data.datasets[0].data = percentages;
            mixChart.options.renewableValue = renewablePercent;
            mixChart.update();

            document.getElementById('displayYearText').innerText = currentMixYear;
            document.getElementById('displayYearGen').innerText = data.total.toFixed(1);
        }

        function addRow() {
            const tbody = document.querySelector('#energyTable tbody');
            const newRow = document.createElement('tr');
            newRow.className = 'energy-row';
            newRow.innerHTML = `
                <td class="py-2 pr-2 font-semibold text-slate-700"><input type="text" value="æ–°èƒ½æº" class="bg-transparent border-none p-0 w-full"></td>
                <td><input type="number" value="30" step="0.01" oninput="calculate()" class="cf-input w-full text-center bg-transparent"></td>
                <td class="px-1"><input type="number" value="1.00" step="0.01" oninput="calculate()" class="cap-2026 w-full text-center border rounded p-0.5"></td>
                <td class="px-1"><input type="number" value="2.00" step="0.01" oninput="calculate()" class="cap-2030 w-full text-center border rounded p-0.5"></td>
                <td class="px-1"><input type="number" value="3.00" step="0.01" oninput="calculate()" class="cap-2035 w-full text-center border rounded p-0.5"></td>
                <td class="px-1"><input type="number" value="5.00" step="0.01" oninput="calculate()" class="cap-2050 w-full text-center border rounded p-0.5 font-bold"></td>
                <td class="text-right"><button onclick="deleteRow(this)" class="text-slate-300 hover:text-red-500 transition-colors">âœ•</button></td>
            `;
            tbody.appendChild(newRow);
            calculate();
        }

        function deleteRow(btn) {
            btn.closest('tr').remove();
            calculate();
        }

        window.onload = function() {
            initCharts();
            calculate();
        };
    </script>
</body>
</html>
